# bat 命令学习笔记

### 一、常用命令

#### pause

让当前程序暂停一下

```
pause>nul 将请按任意键继续....隐藏

```

####  ::

冒号后紧跟一个非字母数字的一个特殊符号， goto 无法识别的标号，可以起到注释作用  ，只能单独一行

注释，类似于java中的   /**  xxx  */  其中的内容不会打印出来 



#### rem



#### echo

```
1、echo on 打开命令行回显状态  
2、@echo 运行时隐藏命令（不在 terminal 上显示）echo 运行时显示命令（在 terminal 上显示）
# @echo off 会将C:\User> 这串显示隐藏，且隐藏接下来的命令。
# echo off  会在输入这个命令之后隐藏接下来的输入的命令。
3、打印很多行，可以使用&符连接
4、输出空行，相当于输入一个回车  echo.
echo.|time  #ECHO．输出的回车，经 DOS 管道转向可以作为其它命令的输入
5、echo crtl+g 使喇叭鸣响
```

#### type

打印文件内容



#### color

第一个数为背景色，第二个数为前景

```
0 = 黑色 8 = 灰色
1 = 蓝色 9 = 淡蓝色
2 = 绿色 A = 淡绿色
3 = 湖蓝色 B = 淡浅绿色
4 = 红色 C = 淡红色
5 = 紫色 D = 淡紫色
6 = 黄色 E = 淡黄色
7 = 白色 F = 亮白色
```



#### title

设置终端的标题



#### goto

跳转，在提出里中允许以：xxx 来构建一个标号，然后用 GOTO XXX 跳转到标号:XXX 处，然后执行标号后的命
令  

```
任何以冒号:开头的字符行, 在批处理中都被视作标号, 而直接忽略其后的所有内容。
有效标号：冒号后紧跟一个以字母数字开头的字符串， goto 语句可以识别。
无效标号：冒号后紧跟一个非字母数字的一个特殊符号， goto 无法识别的标号，可以起到注释作用，所以 ::
常被用作注释符号，其实 :+ 也可起注释作用
```



#### set

批处理中设置变量的方法 set var=xxx，批处理中要使用这个变量就通过%var%引用

> /p 根据用户输入的值做相应的操作( set /p var=输入变量：   =右边是提示语)

```
#set /p vertion="input version:"
#echo % version%
```

> /a 命令行开关指定等号哟便的字符串为被评估的的数字表达式

```
#set /a var= 1+1
#echo %var%
```

> %PATH:str1=str2%  将str1替换为str2

```
#@echo off
#set a=www.baidu.com
#echo 替换前的值：%a%
#set %a:.=!%
#echo 替换后的值：%a%
```

> %PATH:~10，5%  显示变量PATH里指定第几位开始显示几位

```
#@echo off 
#set a=bbs.verybat.cn
#set var=%a~0,3% 
#echo %var%            -->结果显示为bbs

//当set var=%a~0,-3% 意思是从0位开始到倒数第二为之间的值赋值给变量，即bbs.verybat
```



#### find

在文件中搜索字符串

```
//判断文件是否存在
if（not） exist AndroidManifest.xml goto  chage_version_code

```



#### start

批处理中调用外部程序的命令，外部程序在新窗口执行，批处理程序继续往下执行，不理会外部程序的运行情况。



#### call

可以在批处理执行过程中调用另一个批处理，当另一个批才处理执行完成之后，在继续执行原来的批处理。

```
#set aa=123456
#set cmdstr=echo %aa%
#call %cmdstr%
#pause
```



#### cd

切换目录

```
cd /d d:\test 更改当前目录为d:\test
```



#### pushd

保存当前目录，并切换到当前目录

```
pushd c:\test
```



#### popd

恢复当前目录为刚才保存的目录

```
popd  恢复为刚才保存的目录
```



#### shift

更改批处理文件中可替换参数的位置



#### if

```
@echo off
dir c:
rem 退出代码为>=1 就跳至标题 1 处执行， >=0 就跳至标题 0 处执行
IF ERRORLEVEL 1 goto 1
IF ERRORLEVEL 0 goto 0
Rem 上面的两行不可交换位置，否则失败了也显示成功。
:0
echo 命令执行成功！
Rem 程序执行完毕跳至标题 exit 处退出
goto exit
:1
echo 命令执行失败！
Rem 程序执行完毕跳至标题 exit 处退出
goto exit
:exit
pause
```



#### setlocal

> 批处理读取命令时是按行读取的（另外例如 for 命令等，其后用一对圆括号闭合的所有语句也当作一行），
> 在处理之前要完成必要的预处理工作，这其中就包括对该行命令中的变量赋值  

```
变量延迟的启动语句是“setlocal enabledelayedexpansion”并且变量要用一对叹号“!!”括起来（注意要用英文的叹号），否则就没有变量延迟的效果

@echo off
setlocal enabledelayedexpansion
set a=4
set a=5 & echo !a!
pause

由于启动了变量延迟，所以批处理能够感知到动态变化，即不是先给该行变量赋值，而是在运行过程中给变量赋值，因此此时 a 的值就是 5 


```



#### for...do 

```
@echo off
setlocal enabledelayedexpansion
for /l %%i in (1,1,5) do (
set a=%%i
echo !a!
)
pause

%%i 指定变量，起变量的作用
```



#### attrib

显示或更改文件属性  



### 二、常用特殊符号

#### %

```
引用变量用%var%，调用程序外部参数用%1 至%9 等等
%0 %1 %2 %3 %4 %5 %6 %7 %8 %9 %*为命令行传递给批处理的参数
%0 批处理文件本身，包括完整的路径和扩展名
%1 第一个参数
%9 第九个参数
%* 从第一个参数开始的所有参数
参数%0 具有特殊的功能，可以调用批处理自身，以达到批处理本身循环的目的，也可以复制文件自身等
等
```



#### <、 >&、 <& 重定向符  

```
< ，输入重定向命令，从文件中读入命令输入，而不是从键盘中读入
@echo off
echo 2005-05-01>temp.txt
date <temp.txt
del temp.txt
```

```
>&，将一个句柄的输出写入到另一个句柄的输入中。
<&，刚好和>&相反，从一个句柄读取输入并将其写入到另一个句柄输出中

常用句柄： 0、 1、 2，未定义句柄： 3—9
1>nul 表示禁止输出正确的信息
2>nul 表示禁止输出错误信息。
其中的 1 与 2 都是代表某个数据流输入输出的地址（ NT CMD 称之为句柄， MSDOS 称之为设备）。
句柄 0：标准输入 stdin，键盘输入
句柄 1：标准输出 stdout，输出到命令提示符窗口（ console，代码为 CON）
句柄 2：标准错误 stderr，输出到命令提示符窗口（ console，代码为 CON）
其中的 stdin 可被<重定向， stdout 可被>、 >>重定向
```



#### | 命令管道符  

```
格式：第一条命令 | 第二条命令 [| 第三条命令...]
将第一条命令的结果作为第二条命令的参数来使用

dir c:\|find "txt"

```



#### ^    转义字符

```
^是对特殊符号<,>,&的前导字符，在命令中他将以上 3 个符号的特殊功能去掉，仅仅只把他们当成符号而
不使用他们的特殊意义
```



#### & 组合命令  

```
语法：第一条命令 & 第二条命令 [& 第三条命令...]
&、 &&、 ||为组合命令，顾名思义，就是可以把多个命令组合起来当一个命令来执行。这在批处理脚本里是
允许的
这个符号允许在一行中使用 2 个以上不同的命令，当第一个命令执行失败了，也不影响后边的命令执行。
这里&两边的命令是顺序执行的，从前往后执行

```



#### &&组合命令

```
语法：第一条命令 && 第二条命令 [&& 第三条命令...]
用这种方法可以同时执行多条命令，当碰到执行出错的命令后将不执行后面的命令，如果一直没有出错则
一直执行完所有命令
这个命令和上边的类似，但区别是，第一个命令失败时，后边的命令也不会执行

```



#### ||组合命令

```
语法：第一条命令 || 第二条命令 [|| 第三条命令...]
用这种方法可以同时执行多条命令，当一条命令失败后才执行第二条命令，当碰到执行正确的命令后将不
执行后面的命令，如果没有出现正确的命令则一直执行完所有命令；
提示：组合命令和重定向命令一起使用必须注意优先级
管道命令的优先级高于重定向命令，重定向命令的优先级高于组合命令

```



#### "" 字符串界定符  

```
双引号允许在字符串中包含空格，进入一个特殊目录
cd "program files"
cd progra~1
cd pro*

三种方法都可以进入 program files 这个目录
```



#### ；

```
分号，当命令相同时，可以将不同目标用；来隔离，但执行效果不变，如执行过程中发生错误，则只返回
错误报告，但程序仍会执行

dir c:\;d:\;e:\;z:\
```



#### （）

```
括号在 for 语句和 if 语句中常见，用来嵌套使用循环或条件语句，其实括号()也可以单独使用

命令： echo 1 & echo 2 & echo 3
可以写成：
(
echo 1
echo 2
echo 3
)
```



#### ！

```
表示变量，即%var%应该表示为!var!
```





### 三、Dos 循环

FOR %%variable IN (set) DO command [command-parameters]

> %%variable 指定一个单一字母表示可替换的参数。
> (set) 指定一个或一组文件。可以使用通配符。
> command 指定对每个文件执行的命令。
> command-parameters
> 为特定命令指定参数或命令行开关

```
/d 主要用于目录搜索,不会搜索文件
@echo off
for /d %%i in (c:\*) do echo %%i
pause
//*号表示任意 N 个字符,而?号只表示任意一个字符

@echo off
for /d %%i in (???) do echo %%i
pause
当前目录下有目录名字只有 1-3 个字母的,就会显示出来,没有就不显示
```



FOR /R [[drive:]path] %%variable IN (set) DO command [command-parameters]  

> 检查以 [drive:]path 为根的目录树，指向每个目录中的
> FOR 语句。如果在 /R 后没有指定目录，则使用当前
> 目录。如果集仅为一个单点(.)字符，则枚举该目录树。
> 递归  

```
1、 set 中的文件名如果含有通配符(？或*)，则列举/R 参数指定的目录及其下面的所用子目录中与 set
相符合的所有文件，无相符文件的目录则不列举
2、相反，如果 set 中为具体文件名，不含通配符，则枚举该目录树（即列举该目录及其下面的所有子
目录），而不管 set 中的指定文件是否存在。这与前面所说的单点（ .）枚举目录树是一个道理，单点代表
当前目录，也可视为一个文件

@echo off
for /r c:\ %%i in (*.exe) do echo %%i
pause

@echo off
for /r c:\ %%i in (boot.ini) do if exist %%i echo %%i
pause
搜索文件
```

